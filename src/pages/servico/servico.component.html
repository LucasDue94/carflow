<section class="container grid grid-nogutter p-3 w-full ">
  <p-table #dt class="w-full h-full shadow-1 " [value]="servicos" stripedRows
           size="small"
           [scrollable]="true"
           scrollHeight="flex"
           [virtualScroll]="true"
           [virtualScrollItemSize]="50"
           [loading]="loading"
           [globalFilterFields]="['nome', 'descricao', 'tempoEstimadoMin']"
           [tableStyle]="{ 'min-width': '75rem' }">
    <ng-template #caption>
      <h3 class="session-title m-2 mb-3">Serviços</h3>
      <section class="flex justify-content-between  mb-2">
        <p-input-group class="w-13rem">
          <p-inputgroup-addon>
            <i class="pi pi-search"></i>
          </p-inputgroup-addon>
          <input pInputText type="text" [(ngModel)]="searchValue"
                 (input)="dt.filterGlobal($event.target.value, 'contains')" placeholder="Pesquisa..."/>
        </p-input-group>
        <div>
          <p-button (click)="openModalNovoServico()" icon="pi pi-plus" class="ml-3 rotate-hover" label="Novo"
                    styleClass="rotate-hover" [rounded]="true"
                    severity="success"/>
        </div>
      </section>
    </ng-template>

    <ng-template #header>
      <tr>
        <th pSortableColumn="nome">
          <div class="flex items-center gap-2">
            Nome
            <p-sortIcon field="nome"/>
          </div>
        </th>
        <th pSortableColumn="tempoEstimadoMin">
          <div class="flex items-center gap-2">
            Tempo Estimado
            <p-sortIcon field="tempoEstimadoMin"/>
          </div>
        </th>
        <th>Descricao</th>
        <th>#</th>
      </tr>
    </ng-template>
    <ng-template #body let-servico>
      <tr>
        <td>{{ servico.nome }}</td>
        <td>{{ servico.tempoEstimadoMin }}</td>
        <td>{{ servico.descricao }}</td>
        <td>
          <p-button icon="pi pi-pencil" (click)="openModalEdicaoServico(servico)" [rounded]="true" [text]="true"
                    severity="primary"/>
          <p-button icon="pi pi-trash" [rounded]="true" [text]="true" severity="danger"/>
        </td>
      </tr>
    </ng-template>
  </p-table>
</section>

<p-dialog (onHide)="close()" [closable]="true" [closeOnEscape]="true" header="Novo Serviço" [modal]="true"
          [(visible)]="displayModalNovoServico" [style]="{ width: '40vw' }">
  <app-servico-form></app-servico-form>
  <ng-template #footer>
    <button pButton (click)="close()" severity="danger" class="mr-2 ">Cancelar</button>
    <button pButton (click)="salvar()" severity="primary">Salvar</button>
  </ng-template>
</p-dialog>

<p-dialog (onHide)="close()" [closable]="true" [closeOnEscape]="true" header="Editar Serviço" [modal]="true"
          [(visible)]="displayModalEdicaoServico" [style]="{ width: '40vw' }">
  <app-servico-form [initialValue]="currentServico" [isEdit]="true"></app-servico-form>
  <ng-template #footer>
    <button pButton (click)="close()" severity="danger" class="mr-2 ">Cancelar</button>
    <button pButton (click)="salvar()" severity="primary">Salvar</button>
  </ng-template>
</p-dialog>
